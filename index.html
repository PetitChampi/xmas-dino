<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Start screen</title>
  <link rel="stylesheet" href="css/game.css">
</head>
<body class="score-body">
  <label for="nickname">enter nickname</label>
  <input type="text" name="nickname" id="nickname" data-nickname>
  <span class="hide" style="color: red;" data-noname>gotta get a name bro</span>
  <p>choose avatar</p>
  <div class="choose-avatar">
    <div class="avatar avatar-focus" data-blue></div>
    <div class="avatar" data-yellow></div>
    <div class="avatar" data-green></div>
    <div class="avatar" data-red></div>
  </div>
  <a href="" style="background-color: bisque; padding: 10px; margin-top: 30px;" data-play-btn>play</a>

  <script>
    let input = document.querySelector("[data-nickname]")
    let playBtn = document.querySelector("[data-play-btn]")
    let nameError = document.querySelector("[data-noname]")
    let avatarElems = document.querySelectorAll(".avatar")
    let green = document.querySelector("[data-green]")
    let yellow = document.querySelector("[data-yellow]")
    let red = document.querySelector("[data-red]")
    let blue = document.querySelector("[data-blue]")
    let nickname = input.value
    let avatar = blue

    window.addEventListener('load', () => { 
      nickname = input.value
    })

    document.addEventListener("click", chooseAvatar)

    input.addEventListener("input", () => {
      if (!nameError.classList.contains("hide")) nameError.classList.add('hide')
      nickname = input.value
      localStorage.setItem("nickname", nickname)
    })

    playBtn.addEventListener("click", e => {
      e.preventDefault()
      if (nickname === "") {
        nameError.classList.remove('hide')
      } else window.location.href = "game.html"
    })

    function chooseAvatar(e) {
      if (e.target != green &&
      e.target != blue &&
      e.target != yellow &&
      e.target != red) return

      avatarElems.forEach(elem => {
        if (elem.classList.contains("avatar-focus")) elem.classList.remove("avatar-focus")
      })

      e.target.classList.add("avatar-focus")

      switch (e.target) {
        case green:
          avatar = 'green'
          break
        case blue:
          avatar = 'blue'
          break
        case yellow:
          avatar = 'yellow'
          break
        case red:
          avatar = 'red'
          break
      }
      localStorage.setItem("avatar", avatar)
    }
  </script>
</body>
</html>